---
import type { Lang } from '@/i18n';
import { t, getBaseUrl } from '@/i18n';
import { getFooterNavigation, dropdownIcons } from '@/data/navigation';
import { cities } from '@/data/cities';

interface Props {
  lang: Lang;
}

const { lang } = Astro.props;
const navigation = getFooterNavigation(lang);
const currentCity = cities[0]; // Default to Moscow for contact info
const base = getBaseUrl(lang);
---

<footer>
  <div class="footer-contacts">
    <div class="footer-brand">
      <a href={base || '/'}>
        <img src="/img/logo.svg" alt="Rustrade" class="footer-logo" width="160" height="44" />
      </a>
      <span class="footer-brand-divider"></span>
      <p class="footer-slogan">
        <span>{lang === 'ru' ? 'Энергетические решения,' : 'Energy solutions'}</span>
        <span>{lang === 'ru' ? 'которые окупаются' : 'that pay off'}</span>
      </p>
    </div>
    
    <div class="contact-item">
      <img src="/img/mail.svg" alt="email" width="20" height="20" />
      <a href={`mailto:${currentCity?.email}`}>{currentCity?.email}</a>
    </div>
    
    <div class="contact-item">
      <img src="/img/phone.svg" alt="phone" width="20" height="20" />
      <a href={`tel:${currentCity?.phone.replace(/[^+\d]/g, '')}`}>{currentCity?.phone}</a>
    </div>
    
    <div class="contact-item">
      <img src="/img/location.svg" alt="address" width="20" height="20" />
      <span>{currentCity?.address[lang]}</span>
    </div>
    
    <div class="contact-item contact-item-hours">
      <svg class="footer-clock" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <path d="M12 6v6l4 2"/>
      </svg>
      <span class="working-hours">
        <span>{t('footer.workingHoursLabel', lang)}</span>
        <span>{currentCity?.workingHours[lang]}</span>
      </span>
    </div>
  </div>

  <nav class="footer-nav">
    <div class="footer-nav-links">
      {navigation.map((item) => (
        <a href={item.href}>{item.name}</a>
      ))}
      <a href="/Презентация_РУСТРЕЙД.pdf" download style="display: flex; align-items: center; gap: 8px; color: var(--color-error);">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" set:html={dropdownIcons.presentation} />
        {t('footer.downloadPresentation', lang)}
      </a>
    </div>
  </nav>
  
  <div class="footer-subscription">
    <h4>{t('footer.subscribe', lang).split('.')[0]}</h4>
    <p>{t('footer.subscribe', lang)}</p>
    
    <form class="footer-subscription-form" data-form="subscribe">
      <input 
        type="email" 
        name="email" 
        placeholder={t('footer.enterEmail', lang)}
        required
      />
      <button type="submit">
        {t('forms.submit', lang)}
      </button>
    </form>
  </div>
  
  <div class="footer-bottom">
    <span>© {new Date().getFullYear()} Rustrade. {lang === 'ru' ? 'Все права защищены.' : 'All rights reserved.'}</span>
    <a href={`${base}/privacy-policy`}>{t('nav.privacy', lang)}</a>
  </div>
</footer>

<style>
  @import '../styles/components/footer.css';
</style>
